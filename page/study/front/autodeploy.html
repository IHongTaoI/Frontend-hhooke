<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>🍧 手写自动化部署 | 洪涛的传奇生涯</title>
    <meta name="description" content="技术只是浮云，生活才是真正的追求。我们要做的就是好好生活顺便把事干好。">
    
    
    <link rel="preload" href="/hhooke/assets/css/0.styles.a9061947.css" as="style"><link rel="preload" href="/hhooke/assets/js/app.f575e0ae.js" as="script"><link rel="preload" href="/hhooke/assets/js/2.bcb894d3.js" as="script"><link rel="preload" href="/hhooke/assets/js/14.a06588e6.js" as="script"><link rel="prefetch" href="/hhooke/assets/js/10.de1dc77b.js"><link rel="prefetch" href="/hhooke/assets/js/11.08c6aff8.js"><link rel="prefetch" href="/hhooke/assets/js/12.f25ca835.js"><link rel="prefetch" href="/hhooke/assets/js/13.7ee9bba7.js"><link rel="prefetch" href="/hhooke/assets/js/15.98f6b7dd.js"><link rel="prefetch" href="/hhooke/assets/js/16.af03b056.js"><link rel="prefetch" href="/hhooke/assets/js/17.a7e5d66a.js"><link rel="prefetch" href="/hhooke/assets/js/18.91396e0f.js"><link rel="prefetch" href="/hhooke/assets/js/19.2dc99a09.js"><link rel="prefetch" href="/hhooke/assets/js/20.53ecdb43.js"><link rel="prefetch" href="/hhooke/assets/js/21.b037c0a3.js"><link rel="prefetch" href="/hhooke/assets/js/22.f5c91341.js"><link rel="prefetch" href="/hhooke/assets/js/23.f380d4df.js"><link rel="prefetch" href="/hhooke/assets/js/24.aaf617dd.js"><link rel="prefetch" href="/hhooke/assets/js/25.c4078de4.js"><link rel="prefetch" href="/hhooke/assets/js/26.3a491fe2.js"><link rel="prefetch" href="/hhooke/assets/js/27.db72b66b.js"><link rel="prefetch" href="/hhooke/assets/js/28.822aa44f.js"><link rel="prefetch" href="/hhooke/assets/js/29.dd2e18b5.js"><link rel="prefetch" href="/hhooke/assets/js/3.938f1f69.js"><link rel="prefetch" href="/hhooke/assets/js/30.a2607e02.js"><link rel="prefetch" href="/hhooke/assets/js/31.616db8d1.js"><link rel="prefetch" href="/hhooke/assets/js/32.5397603f.js"><link rel="prefetch" href="/hhooke/assets/js/33.4beca9b3.js"><link rel="prefetch" href="/hhooke/assets/js/34.dcb49f4c.js"><link rel="prefetch" href="/hhooke/assets/js/35.10a1e8e9.js"><link rel="prefetch" href="/hhooke/assets/js/36.002d7d4d.js"><link rel="prefetch" href="/hhooke/assets/js/37.969e1ff5.js"><link rel="prefetch" href="/hhooke/assets/js/38.f049f5ec.js"><link rel="prefetch" href="/hhooke/assets/js/39.945b79f6.js"><link rel="prefetch" href="/hhooke/assets/js/4.dc3c1090.js"><link rel="prefetch" href="/hhooke/assets/js/40.30b722fb.js"><link rel="prefetch" href="/hhooke/assets/js/41.3ba730ea.js"><link rel="prefetch" href="/hhooke/assets/js/42.6609662e.js"><link rel="prefetch" href="/hhooke/assets/js/43.d9c8646a.js"><link rel="prefetch" href="/hhooke/assets/js/44.915367f0.js"><link rel="prefetch" href="/hhooke/assets/js/45.590ff73c.js"><link rel="prefetch" href="/hhooke/assets/js/5.436b6a35.js"><link rel="prefetch" href="/hhooke/assets/js/6.298ca52f.js"><link rel="prefetch" href="/hhooke/assets/js/7.7cfafc2a.js"><link rel="prefetch" href="/hhooke/assets/js/8.8f5a74e7.js"><link rel="prefetch" href="/hhooke/assets/js/9.ce6e61c9.js">
    <link rel="stylesheet" href="/hhooke/assets/css/0.styles.a9061947.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hhooke/" class="home-link router-link-active"><!----> <span class="site-name">洪涛的传奇生涯</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hhooke/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><span class="title">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hhooke/study/git/" class="nav-link">关于git</a></li><li class="dropdown-item"><!----> <a href="/hhooke/study/front/autodeploy.html" class="nav-link router-link-exact-active router-link-active">大前端</a></li><li class="dropdown-item"><!----> <a href="/hhooke/study/javascript/base.html" class="nav-link">Javascript</a></li><li class="dropdown-item"><!----> <a href="/hhooke/study/other/weixinpub.html" class="nav-link">填坑指南</a></li></ul></div></div><div class="nav-item"><a href="/hhooke/favorite/" class="nav-link">收藏工具</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="我的博客" class="dropdown-title"><span class="title">我的博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://juejin.im/user/5a16ce4f5188254dd9361351" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/d842c79cf424" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://www.hhooke.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人网站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/IHongTaoI" target="_blank" rel="noopener noreferrer" class="repo-link">
    github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/hhooke/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><span class="title">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/hhooke/study/git/" class="nav-link">关于git</a></li><li class="dropdown-item"><!----> <a href="/hhooke/study/front/autodeploy.html" class="nav-link router-link-exact-active router-link-active">大前端</a></li><li class="dropdown-item"><!----> <a href="/hhooke/study/javascript/base.html" class="nav-link">Javascript</a></li><li class="dropdown-item"><!----> <a href="/hhooke/study/other/weixinpub.html" class="nav-link">填坑指南</a></li></ul></div></div><div class="nav-item"><a href="/hhooke/favorite/" class="nav-link">收藏工具</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="我的博客" class="dropdown-title"><span class="title">我的博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://juejin.im/user/5a16ce4f5188254dd9361351" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/d842c79cf424" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="http://www.hhooke.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人网站
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/IHongTaoI" target="_blank" rel="noopener noreferrer" class="repo-link">
    github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hhooke/study/front/autodeploy.html" class="active sidebar-link">🍧 手写自动化部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hhooke/study/front/autodeploy.html#一、搭建git服务器" class="sidebar-link">💥 一、搭建git服务器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hhooke/study/front/autodeploy.html#_1-服务器安装git" class="sidebar-link">1. 服务器安装git</a></li><li class="sidebar-sub-header"><a href="/hhooke/study/front/autodeploy.html#_2-创建一个系统用户进行git仓库的管理" class="sidebar-link">2. 创建一个系统用户进行git仓库的管理</a></li><li class="sidebar-sub-header"><a href="/hhooke/study/front/autodeploy.html#_3-创建项目仓库" class="sidebar-link">3. 创建项目仓库</a></li></ul></li><li class="sidebar-sub-header"><a href="/hhooke/study/front/autodeploy.html#二、配置sshd-免密码连接" class="sidebar-link">💥 二、配置sshd 免密码连接</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hhooke/study/front/autodeploy.html#_1-服务器上建立ssh验证" class="sidebar-link">1. 服务器上建立ssh验证</a></li><li class="sidebar-sub-header"><a href="/hhooke/study/front/autodeploy.html#_2-客户端配置ssh" class="sidebar-link">2. 客户端配置ssh</a></li></ul></li><li class="sidebar-sub-header"><a href="/hhooke/study/front/autodeploy.html#三、创建客户端本地项目" class="sidebar-link">💥 三、创建客户端本地项目</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/hhooke/study/front/autodeploy.html#_1-客户端拉取代码" class="sidebar-link">1. 客户端拉取代码</a></li><li class="sidebar-sub-header"><a href="/hhooke/study/front/autodeploy.html#_2-配置本地代码" class="sidebar-link">2. 配置本地代码</a></li><li class="sidebar-sub-header"><a href="/hhooke/study/front/autodeploy.html#_3-服务器运行代码" class="sidebar-link">3. 服务器运行代码</a></li></ul></li><li class="sidebar-sub-header"><a href="/hhooke/study/front/autodeploy.html#四、编写git钩子" class="sidebar-link">💥 四、编写git钩子</a></li></ul></li><li><a href="/hhooke/study/front/frontdebug.html" class="sidebar-link">🍧 前端调试</a></li><li><a href="/hhooke/study/front/architects.html" class="sidebar-link">🍧 前端架构</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>更多</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="手写自动化部署"><a href="#手写自动化部署" class="header-anchor">#</a> 🍧 手写自动化部署</h1> <h2 id="一、搭建git服务器"><a href="#一、搭建git服务器" class="header-anchor">#</a> 💥 一、搭建git服务器</h2> <blockquote><p>本人使用的是 cenos 系统的腾讯云服务器</p></blockquote> <hr> <ul><li><h3 id="_1-服务器安装git"><a href="#_1-服务器安装git" class="header-anchor">#</a> 1. <strong>服务器安装git</strong></h3> <div class="language-bash extra-class"><pre class="language-bash"><code>yum <span class="token function">install</span> -y <span class="token function">git</span>
</code></pre></div><p>安装完了之后使用命令查看版本，检验是否安装成功。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> --version
</code></pre></div></li> <li><h3 id="_2-创建一个系统用户进行git仓库的管理"><a href="#_2-创建一个系统用户进行git仓库的管理" class="header-anchor">#</a> 2. <strong>创建一个系统用户进行git仓库的管理</strong></h3> <p>我起的是 htgit(先检测这个用户是否存在)</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">[</span>root@VM_183_60_centos hongtao<span class="token punctuation">]</span><span class="token comment"># id htgit</span>
</code></pre></div><p>如果存在会出现:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">1001</span><span class="token punctuation">(</span>htgit<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">1001</span><span class="token punctuation">(</span>htgit<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">1001</span><span class="token punctuation">(</span>htgit<span class="token punctuation">)</span>
</code></pre></div><p>如果不存在则提示</p> <div class="language-bash extra-class"><pre class="language-bash"><code>id: htgit: no such user
</code></pre></div><p>就可以创建用户了,输入以下命令</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">useradd</span> htgit
</code></pre></div><p>创建完成使用<code>id htgit</code>检测是否创建成功</p></li> <li><h3 id="_3-创建项目仓库"><a href="#_3-创建项目仓库" class="header-anchor">#</a> 3. <strong>创建项目仓库</strong></h3> <p>创建一个项目文件夹</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">mkdir</span> -p <span class="token operator">&lt;</span>文件夹名字<span class="token operator">&gt;</span>
<span class="token comment"># 比如我的是</span>
<span class="token function">mkdir</span> -p mypro
</code></pre></div><p>创建git仓库</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">mkdir</span> -p myblog.git
</code></pre></div><p>初始化git仓库</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> init --bare myblog.git
</code></pre></div><p>使用 <code>ll</code>命令查看目录信息</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ll</span>
drwxr-xr-x  <span class="token number">2</span> root root <span class="token number">4096</span> Jan <span class="token number">29</span> <span class="token number">16</span>:19 myblog.git
</code></pre></div><p>myblog.git 是归属root用户的，现在修改成我们之前新建的htgit用户。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">chown</span> -R htgit:htgit myblog.git
</code></pre></div><p>服务器拉取服务器git仓库的代码</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> clone ./myblog.git
</code></pre></div><p><code>ll</code>查看当前文件夹</p> <div class="language-bash extra-class"><pre class="language-bash"><code>drwxr-xr-x  <span class="token number">3</span> root  root  <span class="token number">4096</span> Jan <span class="token number">29</span> <span class="token number">16</span>:34 myblog
drwxr-xr-x  <span class="token number">7</span> htgit htgit <span class="token number">4096</span> Jan <span class="token number">29</span> <span class="token number">16</span>:26 myblog.git
</code></pre></div><blockquote><p>注意：把<code>myblog</code>目录也要改成<code>htgit</code>用户的权限，否则git钩子在操作的时候会没有权限</p></blockquote></li></ul> <h2 id="二、配置sshd-免密码连接"><a href="#二、配置sshd-免密码连接" class="header-anchor">#</a> 💥 二、配置sshd 免密码连接</h2> <hr> <ul><li><h3 id="_1-服务器上建立ssh验证"><a href="#_1-服务器上建立ssh验证" class="header-anchor">#</a> 1. <strong>服务器上建立ssh验证</strong></h3> <p>使用 <code>cd ~htgit</code> 或者 <code>cd /home/htgit</code> 进入到我们htgit的用户目录,创建.ssh文件夹。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">mkdir</span> .ssh
</code></pre></div><p>更改权限</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">chown</span> -R htgit:htgit .ssh
<span class="token function">chmod</span> -R <span class="token number">700</span> .ssh
</code></pre></div><p>进入.ssh/</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> .ssh
</code></pre></div><p>创建 authorized_keys</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">vim</span> authorized_keys
</code></pre></div><blockquote><p>一会需要将客户端的公钥填写到这个文件上</p></blockquote> <p>更改此文件的权限</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">chmod</span> <span class="token number">600</span> authorized_keys
</code></pre></div></li> <li><h3 id="_2-客户端配置ssh"><a href="#_2-客户端配置ssh" class="header-anchor">#</a> 2. <strong>客户端配置ssh</strong></h3> <div class="language-bash extra-class"><pre class="language-bash"><code>ssh-keygen -t rsa -C <span class="token string">'你的邮箱'</span>
</code></pre></div><p>如果之前创建过直接使用就行了</p> <blockquote><p>本人客户端是 windows 系统</p></blockquote> <p>找到系统盘下一般是
<code>C:\Users\用户名\.ssh</code>的<code>id_rsa.pub</code>文件。用编辑器将它打开，将里面的内容复制到之前我们在服务器上创建的那个authorized_keys文件里去。</p></li></ul> <h2 id="三、创建客户端本地项目"><a href="#三、创建客户端本地项目" class="header-anchor">#</a> 💥 三、创建客户端本地项目</h2> <hr> <ul><li><h3 id="_1-客户端拉取代码"><a href="#_1-客户端拉取代码" class="header-anchor">#</a> 1. <strong>客户端拉取代码</strong></h3> <p>比如我是在window系统上，你得安装了git，打开git bash， 输入之前我们在服务器装的git仓库的路径</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> clone htgit@<span class="token punctuation">[</span>你的服务器ip地址<span class="token punctuation">]</span>:<span class="token punctuation">[</span>你的git仓库路径<span class="token punctuation">]</span>
</code></pre></div><p>比如我的:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> clone htgit@139.199.72.20:/usr/hongtao/myblog.git
</code></pre></div></li> <li><h3 id="_2-配置本地代码"><a href="#_2-配置本地代码" class="header-anchor">#</a> 2. <strong>配置本地代码</strong></h3> <p>本人还是以iview-admin项目为例子</p> <p><a href="https://github.com/iview/iview-admin" target="_blank" rel="noopener noreferrer">iview-admin代码地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>进入上一步骤我们<code>git clone</code>下来的目录<code>myblog</code>里</p> <p>这里我就不做演示了，直接将iview-admin的代码拷贝进来。然后提交上传</p></li> <li><h3 id="_3-服务器运行代码"><a href="#_3-服务器运行代码" class="header-anchor">#</a> 3. <strong>服务器运行代码</strong></h3> <p>上一步的操作使得我们服务器上的 <code>myblog.git</code>仓库上有了我们客户端推送过来的代码了，之前我们在服务器上 <code>git clone ./myblog.git</code>的时候也生成了一个myblog的文件夹。进入这个文件夹输入<code>git pull</code>即可获取当前服务器git仓库的最新代码。然后执行</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i
<span class="token function">npm</span> run dev
</code></pre></div><p>之后即可在服务器跑起来了。</p> <p>到了这一步之后我们便知道了如何手动的去运行前端代码了。</p> <p>在服务器上运行前端项目有很多种方式。如：</p> <ul><li><p>nginx静态资源服务器</p></li> <li><p>nodeJs服务器</p></li> <li><p>php服务</p></li> <li><p>。。。等等</p> <blockquote><p>本文以nodejs运行的前端项目为例子。直接使用webpack的热更新运行项目。</p></blockquote></li></ul></li></ul> <h2 id="四、编写git钩子"><a href="#四、编写git钩子" class="header-anchor">#</a> 💥 四、编写git钩子</h2> <hr> <p>进入我们的服务器git仓库文件夹里</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /usr/hongtao/myblog.git
</code></pre></div><p>该目录下有一个hooks目录<code>cd hooks</code>进入</p> <p>编写一个叫post-receive的文件</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">vim</span> post-receive
</code></pre></div><p>写入如下内容</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token assign-left variable">DIR</span><span class="token operator">=</span>/usr/hongtao/myblog
<span class="token builtin class-name">cd</span> <span class="token variable">$DIR</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$DIR</span>
<span class="token builtin class-name">echo</span> <span class="token string">'服务器代码更新'</span>
<span class="token builtin class-name">unset</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">git</span> rev-parse --local-env-vars<span class="token variable">)</span></span>
<span class="token function">git</span> fetch --all
<span class="token function">git</span> reset --hard origin/master
<span class="token function">git</span> pull
<span class="token function">npm</span> <span class="token function">install</span>
</code></pre></div><p>添加可执行权限</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">chmod</span> +x post-receive
</code></pre></div><p>每当我们客户端提交一次代码，这个钩子就会运行一次。由于我们的前端代码是热更新的作用，当代码更新了，我们直接访问的就是我们最新的页面。</p> <p>如有问题请联系 qq：836717428</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/hhooke/study/front/frontdebug.html">🍧 前端调试</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/hhooke/assets/js/app.f575e0ae.js" defer></script><script src="/hhooke/assets/js/2.bcb894d3.js" defer></script><script src="/hhooke/assets/js/14.a06588e6.js" defer></script>
  </body>
</html>
