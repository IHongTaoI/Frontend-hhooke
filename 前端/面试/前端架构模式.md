## 前言

什么是架构，就像我们买电脑一样，如果一个电脑的配件，如 cpu,主板，显卡，内存等都是制作的时候就焊死了，当我们某个配件想升级或者某个配件坏了想维护那是相当困难的一件事。但是如果我们在设计初期就把所有配件的连接点设计成即插即用的接口，那么有配件需要维护或者升级时就会更加的方便，这样的设计无非是更加科学合理的。架构其实我们可以比喻成电脑的机箱，不同的机箱有着不同的架构方式。根据使用场景来选择一个最为合适的架构方式，如经常携带的电脑，就会选择笔记本方式，在家就选择台式机。

---

<a id="TOC"></a>

| 目录             |
| ---------------- |
| [MVC 模式](#d1)  |
| [MVP 模式](#d2)  |
| [MVVP 模式](#d3) |

---

<a id="d1"></a>

#### MVC 模式

[目录](#TOC)

MVC（Model-View-Controller）是最常见的软件架构之一，业界有着广泛应用。

- 模型(Model):数据保存

- 视图(View):用户界面

- 控制器(Controller):业务逻辑

**各部分事件的通信方式** :

![](https://user-gold-cdn.xitu.io/2019/4/24/16a4f801796c586c?w=327&h=211&f=png&s=16306)

1. View 传送指令到达 Controller

2. Controller 完成业务逻辑后,要求 Model 改变状态

3. Model 将新的数据发送到 View,用户得到反馈

**优缺点** :

- 优点

  1. 可以为一个模型在运行时同时建立和使用多个视图。变化-传播机制可以确保所有相关的视图及时得到模型数据变化，从而使所有关联的视图和控制器做到行为同步。

  2. 视图与控制器的可接插性，允许更换视图和控制器对象，而且可以根据需求动态的打开或关闭、甚至在运行期间进行对象替换。

  3. 模型的可移植性。因为模型是独立于视图的，所以可以把一个模型独立地移植到新的平台工作。需要做的只是在新平台上对视图和控制器进行新的修改。

  4. 潜在的框架结构。可以基于此模型建立应用程序框架，不仅仅是用在设计界面的设计中。

* 缺点

  1. 增加了系统结构和实现的复杂性。对于简单的界面，严格遵循 MVC，使模型、视图与控制器分离，会增加结构的复杂性，并可能产生过多的更新操作，降低运行效率。

  2. 视图与控制器间的过于紧密的连接。视图与控制器是相互分离，但确实联系紧密的部件，视图没有控制器的存在，其应用是很有限的，反之亦然，这样就妨碍了他们的独立重用。

  3. 视图对模型数据的低效率访问。依据模型操作接口的不同，视图可能需要多次调用才能获得足够的显示数据。对未变化数据的不必要的频繁访问，也将损害操作性能。

  4. 目前，一般高级的界面工具或构造器不支持模式。改造这些工具以适应 MVC 需要和建立分离的部件的代价是很高的，从而造成 MVC 使用的困难。

##### JavaScript 例子

> 自己写的不是很好，建议参考[这个链接](https://juejin.im/post/593021272f301e0058273468)

- Model

  ```js
  // Model.js

  let value = 0; // 需要操作的数据

  const add = function(v) {
    value += v;
  };

  const sub = function(v) {
    value -= v;
  };

  const getValue = function() {
    return value;
  };

  let views = null;

  // 注册视图
  const registerView = function(v) {
    views = v;
  };

  // 更新视图
  const viewUpdate = function() {
    views.render();
  };

  export default {
    add,
    sub,
    getValue,
    registerView,
    viewUpdate
  };
  ```

* View

  ```js
  import Controller from 'Controller.js';
  import Model from 'Model.js';
  // View.js
  const render = function() {
    let $text = $('#text');
    $text.text(Model.getValue());
  };

  const bindEvent = function(controller) {
    let $addBtn = $('#addBtn'),
      $subBtn = $('#subBtn');

    $addBtn.click(Controller.add);
    $subBtn.click(Controller.sub);
  };

  const init = function() {
    render();
    bindEvent();
  };

  export default {
    init
  };
  ```

- Controller

  ```js
  // Controller.js

  import Model from 'Model.js';
  import View from 'View.js';

  const init = function() {
    View.init();
    Model.registerView(View);
  };

  const add = function() {
    Model.add(1);
    Model.viewUpdate();
  };

  const sub = function(v) {
    Model.add(2);
    Model.viewUpdate();
  };

  export default {
    init,
    add,
    sub
  };
  ```

- 初始化应用

```js
import Controller from 'Controller.js';

Controller.init();
```

---

<a id="d2"></a>

#### MVP 模式

[目录](#TOC)

MVP（Model-View-Presenter）是 MVC 模式的改良，由 IBM 的子公司 Taligent 提出。和 MVC 的相同之处在于：Controller/Presenter 负责业务逻辑，Model 管理数据，View 负责显示。

MVP 模式将 Controller 改名为 Presenter,同时改变了通信方向。

MVP 模式通过解耦 View 和 Model，完全分离视图和模型使职责划分更加清晰。

![](https://upload-images.jianshu.io/upload_images/7792544-41377786e70e14c4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/472/format/webp)

##### JavaScript 例子

- Model

  ```js
  // Model.js

  let value = 0; // 需要操作的数据

  const add = function(v) {
    value += v;
  };

  const sub = function(v) {
    value -= v;
  };

  const getValue = function() {
    return value;
  };

  export default {
    add,
    sub,
    getValue
  };
  ```

* View

  ```js
  import Presenter from 'Presenter.js';
  import Model from 'Model.js';
  // View.js
  const render = function() {
    let $text = $('#text');
    $text.text(Model.getValue());
  };

  const bindEvent = function() {
    let $addBtn = $('#addBtn'),
      $subBtn = $('#subBtn');

    $addBtn.click(Presenter.add);
    $subBtn.click(Presenter.sub);
  };

  const init = function() {
    render();
    bindEvent();
  };

  export default {
    init,
    render
  };
  ```

- Presenter

  ```js
  // Presenter.js
  import View from 'View.js';

  const init = function() {
    View.init();
  };

  const add = function() {
    Model.add(1);
    View.render();
  };

  const sub = function() {
    Model.add(2);
    View.render();
  };

  export default {
    init,
    add,
    sub
  };
  ```

* 入口

  ```js
  import View from 'View.js';

  View.init();
  ```

---

<a id="d3"></a>

#### MVVM 模式

MVVM（Model-View-ViewModel）最早由微软提出。ViewModel 指 "Model of View"——视图的模型。

[目录](#TOC)

![](https://lc-gold-cdn.xitu.io/1fba28fee8c9c5eeb021.png?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)

##### 为什么会有 MVVM 框架

**（复制过来的）** 在过去的 10 年中，我们已经把很多传统的服务端代码放到了浏览器中，这样就产生了成千上万行的 javascript 代码，它们连接了各式各样的 HTML 和 CSS 文件，但缺乏正规的组织形式，这也就是为什么越来越多的开发者使用 javascript 框架。比如：angular、react、vue。浏览器的兼容性问题已经不再是前端的阻碍。前端的项目越来越大，项目的可维护性和扩展性、安全性等成了主要问题。当年为了解决浏览器兼容性问题，出现了很多类库，其中最典型的就是 jquery。但是这类库没有实现对业务逻辑的分成，所以维护性和扩展性极差。综上两方面原因，才有了 MVVM 模式一类框架的出现。比如 vue,通过数据的双向绑定，极大了提高了开发效率。

